{include file="head" /}

{include file="menu" /}

<style>
/* ç°ä»£åŒ–äº§å“ç®¡ç†é¡µé¢æ ·å¼ */
#main-content {
    background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 100%);
    min-height: 100vh;
    padding: 20px;
}

.modern-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 16px;
    padding: 30px;
    margin-bottom: 30px;
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
    color: white;
}

.modern-header h2 {
    margin: 0;
    font-size: 28px;
    font-weight: 700;
    color: white;
}

.modern-header p {
    margin: 8px 0 0 0;
    opacity: 0.95;
    font-size: 14px;
}

.stats-row {
    display: flex;
    gap: 20px;
    margin-bottom: 25px;
}

.stat-card {
    flex: 1;
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
}

.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.12);
}

.stat-card .stat-icon {
    width: 50px;
    height: 50px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    margin-bottom: 12px;
}

.stat-card.total .stat-icon {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.stat-card.active .stat-icon {
    background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
}

.stat-card.inactive .stat-icon {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
}

.stat-card .stat-value {
    font-size: 32px;
    font-weight: 700;
    color: #2d3748;
    margin: 0;
}

.stat-card .stat-label {
    font-size: 13px;
    color: #718096;
    margin-top: 5px;
}

.toolbar {
    background: white;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.search-box {
    display: flex;
    gap: 10px;
    align-items: center;
}

.search-input {
    border: 2px solid #e2e8f0;
    border-radius: 10px;
    padding: 10px 15px;
    width: 300px;
    font-size: 14px;
    transition: all 0.3s ease;
}

.search-input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.btn-modern {
    padding: 10px 24px;
    border-radius: 10px;
    font-weight: 600;
    font-size: 14px;
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.btn-modern.btn-add {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.btn-modern.btn-add:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
}

.btn-modern.btn-sort {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(245, 87, 108, 0.3);
}

.btn-modern.btn-sort:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(245, 87, 108, 0.4);
}

.product-table-container {
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    overflow: hidden;
}

.modern-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
}

.modern-table thead {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.modern-table thead th {
    padding: 18px 15px;
    text-align: left;
    font-weight: 600;
    font-size: 13px;
    color: white;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border: none;
}

.modern-table tbody tr {
    transition: all 0.3s ease;
    border-bottom: 1px solid #e2e8f0;
}

.modern-table tbody tr:hover {
    background: linear-gradient(90deg, #f7fafc 0%, #edf2f7 100%);
    transform: scale(1.01);
}

.modern-table tbody td {
    padding: 16px 15px;
    color: #4a5568;
    font-size: 14px;
    vertical-align: middle;
}

.sort-input {
    width: 60px;
    padding: 8px 10px;
    border: 2px solid #f8f9fa;
    border-radius: 8px;
    text-align: center;
    font-weight: 600;
    transition: all 0.3s ease;
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
    color: #495057;
    box-shadow: 0 2px 8px rgba(255, 255, 255, 0.5), inset 0 1px 3px rgba(0, 0, 0, 0.05);
}

.sort-input:focus {
    outline: none;
    border-color: #e9ecef;
    background: #ffffff;
    box-shadow: 0 0 0 3px rgba(248, 249, 250, 0.6), 0 4px 12px rgba(255, 255, 255, 0.8);
}

.product-id {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 6px 12px;
    border-radius: 8px;
    font-weight: 700;
    font-size: 13px;
    display: inline-block;
}

.product-name {
    font-weight: 600;
    color: #2d3748;
    font-size: 15px;
}

.status-badge {
    padding: 6px 14px;
    border-radius: 20px;
    font-weight: 600;
    font-size: 12px;
    display: inline-block;
    text-align: center;
    min-width: 70px;
}

.status-badge.open {
    background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    color: white;
    box-shadow: 0 2px 8px rgba(56, 239, 125, 0.3);
}

.status-badge.closed {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    color: white;
    box-shadow: 0 2px 8px rgba(245, 87, 108, 0.3);
}

.category-tag {
    background: #edf2f7;
    color: #4a5568;
    padding: 6px 12px;
    border-radius: 8px;
    font-size: 13px;
    font-weight: 500;
}

.value-box {
    background: #f7fafc;
    padding: 6px 10px;
    border-radius: 6px;
    font-weight: 600;
    color: #2d3748;
    display: inline-block;
}

.action-buttons {
    display: flex;
    gap: 6px;
}

.btn-action {
    padding: 8px 12px;
    border-radius: 8px;
    border: none;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 4px;
}

.btn-action.btn-open {
    background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    color: white;
    box-shadow: 0 2px 8px rgba(56, 239, 125, 0.3);
}

.btn-action.btn-open:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(56, 239, 125, 0.4);
}

.btn-action.btn-close {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    color: white;
    box-shadow: 0 2px 8px rgba(245, 87, 108, 0.3);
}

.btn-action.btn-close:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(245, 87, 108, 0.4);
}

.btn-action.btn-edit {
    background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
    color: white;
    box-shadow: 0 2px 8px rgba(25, 84, 123, 0.3);
}

.btn-action.btn-edit:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(25, 84, 123, 0.4);
}

.btn-action.btn-delete {
    background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
    color: white;
    box-shadow: 0 2px 8px rgba(255, 107, 107, 0.3);
}

.btn-action.btn-delete:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    .stats-row {
        flex-direction: column;
    }
    
    .toolbar {
        flex-direction: column;
        gap: 15px;
    }
    
    .search-input {
        width: 100%;
    }
}

/* åŠ è½½åŠ¨ç”» */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modern-table tbody tr {
    animation: fadeIn 0.5s ease;
}

/* å›¾æ ‡æ ·å¼ */
.icon {
    font-size: 16px;
}
</style>

<!--main content start-->
<section id="main-content">
    <section class="wrapper">
        
        <!-- é¡µé¢æ ‡é¢˜ -->
        <div class="modern-header">
            <h2>ğŸ¯ äº§å“ç®¡ç†ä¸­å¿ƒ</h2>
            <p>ç®¡ç†æ‚¨çš„æ‰€æœ‰äº§å“ï¼ŒåŒ…æ‹¬å¼€å¸‚/ä¼‘å¸‚çŠ¶æ€ã€åˆ†ç±»ã€é£æ§å‚æ•°ç­‰</p>
        </div>

        <!-- ç»Ÿè®¡å¡ç‰‡ -->
        <div class="stats-row">
            <div class="stat-card total">
                <div class="stat-icon">ğŸ“¦</div>
                <div class="stat-value" id="totalCount">0</div>
                <div class="stat-label">äº§å“æ€»æ•°</div>
            </div>
            <div class="stat-card active">
                <div class="stat-icon">âœ…</div>
                <div class="stat-value" id="openCount">0</div>
                <div class="stat-label">å¼€å¸‚ä¸­</div>
            </div>
            <div class="stat-card inactive">
                <div class="stat-icon">ğŸ”´</div>
                <div class="stat-value" id="closedCount">0</div>
                <div class="stat-label">ä¼‘å¸‚ä¸­</div>
            </div>
        </div>

        <!-- å·¥å…·æ  -->
        <div class="toolbar">
            <div class="search-box">
                <input type="text" class="search-input" placeholder="ğŸ” æœç´¢äº§å“åç§°ã€ç¼–å·..." id="searchInput">
            </div>
            <div style="display: flex; gap: 10px;">
                <button type="button" class="btn-modern btn-sort" onclick="document.querySelector('#sortForm').submit()">
                    âš¡ ä¿å­˜æ’åº
                </button>
                <a href="{:url('goods/proadd')}">
                    <button type="button" class="btn-modern btn-add">
                        â• æ·»åŠ äº§å“
                    </button>
                </a>
            </div>
        </div>

        <!-- äº§å“åˆ—è¡¨ -->
        <div class="product-table-container">
            <form action="proorder" method="post" id="sortForm">
                <table class="modern-table">
                    <thead>
                        <tr>
                            <th style="width: 80px;">æ’åº</th>
                            <th style="width: 80px;">ç¼–å·</th>
                            <th>äº§å“åç§°</th>
                            <th style="width: 120px;">å¸‚åœºçŠ¶æ€</th>
                            <th style="width: 120px;">æ‰€å±åˆ†ç±»</th>
                            <th style="width: 100px;">éšæœºå€¼</th>
                            <th style="width: 110px;">é£æ§æœ€å°å€¼</th>
                            <th style="width: 110px;">é£æ§æœ€å¤§å€¼</th>
                            <th style="width: 280px;">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="productTableBody">
                        <!-- {volist name="proinfo" id="vo"} -->
                        <tr data-search="{$vo.ptitle} {$vo.pid}">
                            <td>
                                <input class="sort-input" type="text" name="proorder[{$vo.pid}]" value="{$vo.proorder}">
                            </td>
                            <td>
                                <span class="product-id">#{$vo.pid}</span>
                            </td>
                            <td>
                                <span class="product-name">{$vo.ptitle}</span>
                            </td>
                            <td>
                                {if $vo.isopen == 1}
                                    <span class="status-badge open">ğŸŸ¢ å¼€å¸‚</span>
                                {else /}
                                    <span class="status-badge closed">ğŸ”´ ä¼‘å¸‚</span>
                                {/if}
                            </td>
                            <td>
                                <span class="category-tag">{$vo.pcname}</span>
                            </td>
                            <td>
                                <span class="value-box">{$vo.rands}</span>
                            </td>
                            <td>
                                <span class="value-box">{$vo.point_low}</span>
                            </td>
                            <td>
                                <span class="value-box">{$vo.point_top}</span>
                            </td>
                            <td>
                                <div class="action-buttons">
                                    {if $vo.isopen == 1}
                                        <button type="button" class="btn-action btn-close" onclick="isopen(0,{$vo.pid})">
                                            ä¼‘å¸‚
                                        </button>
                                    {else /}
                                        <button type="button" class="btn-action btn-open" onclick="isopen(1,{$vo.pid})">
                                            å¼€å¸‚
                                        </button>
                                    {/if}
                                    <a href="{:url('goods/proadd',array('pid'=>$vo['pid']))}">
                                        <button type="button" class="btn-action btn-edit" title="ç¼–è¾‘äº§å“">
                                            âœï¸ ç¼–è¾‘
                                        </button>
                                    </a>
                                    <button type="button" class="btn-action btn-delete" onclick="deleteinfo('{$vo.pid}')" title="åˆ é™¤äº§å“">
                                        ğŸ—‘ï¸ åˆ é™¤
                                    </button>
                                </div>
                            </td>
                        </tr>
                        <!-- {/volist} -->
                    </tbody>
                </table>
            </form>
        </div>

    </section>
</section>
<!--main content end-->
</section>

{include file="foot" /}

<script>
// ç»Ÿè®¡æ•°æ®
function updateStats() {
    const rows = document.querySelectorAll('#productTableBody tr');
    let totalCount = 0;
    let openCount = 0;
    let closedCount = 0;
    
    rows.forEach(row => {
        if (row.style.display !== 'none') {
            totalCount++;
            const statusBadge = row.querySelector('.status-badge');
            if (statusBadge && statusBadge.classList.contains('open')) {
                openCount++;
            } else {
                closedCount++;
            }
        }
    });
    
    document.getElementById('totalCount').textContent = totalCount;
    document.getElementById('openCount').textContent = openCount;
    document.getElementById('closedCount').textContent = closedCount;
}

// åˆå§‹åŒ–ç»Ÿè®¡
updateStats();

// æœç´¢åŠŸèƒ½
document.getElementById('searchInput').addEventListener('input', function(e) {
    const searchTerm = e.target.value.toLowerCase();
    const rows = document.querySelectorAll('#productTableBody tr');
    
    rows.forEach(row => {
        const searchData = row.getAttribute('data-search').toLowerCase();
        if (searchData.includes(searchTerm)) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
    
    updateStats();
});

/**
 * å¼€ã€ä¼‘å¸‚æ§åˆ¶å™¨
 */
function isopen(data, pid) {
    var formurl = "{:Url('goods/proisopen')}";
    var data = "isopen=" + data + "&pid=" + pid;
    var locurl = "{:Url('admin/goods/prolist')}";
    
    WPpost(formurl, data, locurl);
    return false;
}

/**
 * åˆ é™¤äº§å“
 */
function deleteinfo(id) {
    layer.open({
        content: 'âš ï¸ ç¡®å®šè¦åˆ é™¤è¿™ä¸ªäº§å“å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼',
        btn: ['ç¡®å®šåˆ é™¤', 'å–æ¶ˆ'],
        yes: function(index) {
            var url = "{:url('goods/delpro')}" + "?id=" + id;
            var locurl = "{:Url('admin/goods/prolist')}";
            WPget(url, locurl);
            layer.close(index);
        }
    });
}

// æ·»åŠ å¹³æ»‘æ»šåŠ¨
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
        });
    });
});
</script>